1. List the name , address and phone number of all mechanics, sorted ascending by their 
ages i.e. started with the youngest.

select m_name,address, phone
from carmechanic.m_mechanic
order by birth_date desc;

2.List all data of car owners with a name longer than 10 chracters and an unknown address
sorted by their names.

select * 
from carmechanic.m_owner
where length(o_name) > 10
and address is null
order by o_name;

3.List the identifiers of cars (together with repair time in days) that were repaired 
for more than 30 days . Sort the result descending by repair time(i.e. the longest 
repair should come first).

select car_id, end_date-start_date 
from carmechanic.m_repair
where end_date - start_date > 30
order by 2 desc;

4.How many cars of each color in our database? Sort the result descending by the 
number of cars.

select color, count(color)
from carmechanic.m_car
where color is not null
group by color
order by 2 desc;

5.Which cars were repaired more than four times?The cars should be repaired in the
result by their identifiers ,sorted.

select car_id,count(car_id)
from carmechanic.m_repair
having count(car_id) > 4
group by car_id
order by car_id;

6.What is the average cost of repairing of green cars?

select avg(repair_cost)
from carmechanic.m_car c
join carmechanic.m_repair r
on c.c_id = r.car_id
where color like 'green'
group by color;

7.For each workshop where one mechanic from Debrecen ever worked , determine the 
average salary of the mechanics from Debrecen. The address of the mechanic who live in 
Debrecen starts with 'Debrecen'.Sort the result descending by the average salary.

select w.w_id, avg(salary)
from carmechanic.m_workshop w
join carmechanic.m_works_for f
on w.w_id = f.workshop_id
join carmechanic.m_mechanic m
on f.mechanic_id = m.m_id
where m.address like 'Debrecen%'
having count(w_id) >=1
group by w.w_id
order by 2 desc; 

8.For each car purchased in 2006 , list the name of its new owner and license plate 
number of the car . Sort the result in alphabetical order of names.

select o_name, license_plate_number
from carmechanic.m_car c
join carmechanic.m_owns o
on   c.c_id = o.car_id
join carmechanic.m_owner w
on o.owner_id = w.o_id
where extract(year from date_of_buy) = 2006
order by o_name;

9.List the license plate number of cars whose first sell price is less than average
first sell price of blue cars.

select license_plate_number 
from carmechanic.m_car
where first_sell_price <
(select avg(first_sell_price)
from carmechanic.m_car
where color like 'blue'
group by color);

10.List all data of green cars having lowest first sell price.

select *
from carmechanic.m_car
where color = 'green'
and first_sell_price =
(select min(first_sell_price)
from carmechanic.m_car
where color = 'green');