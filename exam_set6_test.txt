1.What is the color and first sell price of the car with a license plate number 
'ORA025'?

select color , license_plate_number
from carmechanic.m_car
where license_plate_number like 'ORA025';

2.List all data of car models that are not 5-door models (the string '5-door' doesnot 
appear in their details) and whose brand name starts with the same chracters as their
model names.

select *
from carmechanic.m_car_model
where details not like '%5-door%'
and substr(cm_name,1,1) = substr(make,1,1);

3.List the start date of employments (together with associated salary) that are at 
least 5 years long and have not ended yet(the end date is unknown).

select start_of_employment,salary
from carmechanic.m_works_for
where months_between(sysdate,start_of_employment)/12 >= 5
and end_of_employment is null;

4.What is the difference between the highest and lowest price to which each car was 
evaluated?The cars should be represented in the result by their identifiers.Sort the
result descending by the price difference.

select car_id, max(price)-min(price)
from carmechanic.m_car_evaluation
group by car_id
order by 2 desc;

5.Which makes have more than 7 models?

select make
from carmechanic.m_car_model
having count(make) > 7
group by make;

6.Which cars were evaluated worth more than 10 million, what was the price and when did 
the evaluation takes place? the cars should be represented in the result by their 
license plate number.

select license_plate_number,price,evaluation_date
from carmechanic.m_car c
join carmechanic.m_car_evaluation e
on c.c_id = e.car_id
where e.price > 10e6;


7.List the license plate number and average repair cost of blue cars that were 
repaired in at least two different workshops.Sort the list descending by the average 
repair cost.

select license_plate_number,avg(repair_cost)
from carmechanic.m_car c
join carmechanic.m_repair r
on c.c_id = r.car_id
where color like 'blue'
having count(distinct workshop_id) >= 2
group by license_plate_number
order by 2 desc;

8.For each car purchased in 2006, list the name of its new owner and license plate 
number of the car.Sort the result in alphabetical order of names.

select o_name,license_plate_number
from carmechanic.m_car c
join carmechanic.m_owns o
on c.c_id = o.car_id
join carmechanic.m_owner w
on o.owner_id = w.o_id
where extract(year from date_of_buy) = 2006
order by 1;

9.List all data of car evaluations where the price is at least 1.5 millions less
than the average.

select *
from carmechanic.m_car_evaluation
where (select avg(price)
from carmechanic.m_car_evaluation)-price >= 1.5e6;

10.Who is the latest owner of the car with an identifier 172?

select r.o_name
from carmechanic.m_owns c
join carmechanic.m_owner r
on c.owner_id = r.o_id
where car_id = 172
and date_of_buy = (select max(date_of_buy)
from carmechanic.m_owns 
where car_id = 172);


