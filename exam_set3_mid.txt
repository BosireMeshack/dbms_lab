1. List license plate number , color, first sell price of the car with an 
identifier 150?

select license_plate_number,color, first_sell_price 
from carmechanic.m_car
where c_id = 150;

2. List the identifier , color , license plate number of cars with an unknown 
first sell price or a license plate number ending with two zeros. Sort the list 
by color first then by license plate number.

select c_id,license_plate_number,color 
from carmechanic.m_car
where first_sell_price is null
or license_plate_number like '%00'
order by color , license_plate_number;

3.List all data of repairs that crossed a year boundary,i.e, the year
end date differs from the year start date. Sort the list descending by
the duration of repairs.

select *
from carmechanic.m_repair
where extract (year from start_date) <> extract (year from end_date)
order by end_date - start_date desc;

4. What is the difference between the highest and lowest price to which each 
car evaluated ? the car should be represented in the result by their identifiers
and sort the list descending by the price difference.

select car_id, max(price)-min(price)
from carmechanic.m_car_evaluation
group by car_id
order by 2 desc;

5. Which cars were repaired for a total cost greater than 800 000 and what 
is the total cost? the cars should be represented in the result by their 
identifiers.

select car_id, sum(price)
from carmechanic.m_car_evaluation
having sum(price) > 800000
group by car_id;

6. List all car evaluations with the following data: license plate
number, evaluation date, and price .Sort the reult ascending by price.

select license_plate_number,evaluation_date,price
from carmechanic.m_car
join carmechanic.m_car_evaluation
on carmechanic.m_car.c_id = carmechanic.m_car_evaluation.car_id
order by price;

7. List all car model names for which the average first sell price of the cars 
of that model was greater than 5 millions in 2006. 

select cm_name
from carmechanic.m_car
join carmechanic.m_car_model
on carmechanic.m_car.model_id = carmechanic.m_car_model.cm_id
where extract(year from first_sell_date) = 2006
group by cm_name 
having  avg(first_sell_price)> 5000000;


8. List the name of workshop where at least one mechanic from Eger has 
ever worked. Mechanics from eger have an address starting with 'Eger'. the
column name in the result should be 'Workshop'. Each workshop should appear once.

select distinct w_name Workshop
from carmechanic.m_workshop
join carmechanic.m_works_for
on carmechanic.m_workshop.w_id =carmechanic.m_works_for.workshop_id
join carmechanic.m_mechanic
on carmechanic.m_works_for.mechanic_id = carmechanic.m_mechanic.m_id
where carmechanic.m_mechanic.address like 'Eger%';

9. List all data of car evaluations where price is at least 1 million 
greater than the average.

select *
from carmechanic.m_car_evaluation
where price-(select avg(price)
from carmechanic.m_car_evaluation) >= 1000000

10. List the license plate number and the color of cars having the highest
evaluation price.

select license_plate_number,color
from carmechanic.m_car_evaluation
join carmechanic.m_car
on carmechanic.m_car_evaluation.car_id = carmechanic.m_car.c_id
where price =(select max(price)
from carmechanic.m_car_evaluation);
